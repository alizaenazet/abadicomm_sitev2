---
import Layout from "../../layouts/Layout.astro";
import { getCollection } from "astro:content";
import { ArrowLeft, Calendar, User, Tag } from "@lucide/svelte";

export async function getStaticPaths() {
    const portfolios = await getCollection("portfolios");
    return portfolios.map((entry) => ({
        params: { slug: entry.data.title.replace(/\s+/g, '_') },
        props: {
            portfolio: {
                ...entry.data,
                slug: entry.data.title.replace(/\s+/g, '_'),
                id: entry.data.title.replace(/\s+/g, '_'),
            },
        },
    }));
}

const { portfolio } = Astro.props;
---

<Layout
    title={`${portfolio.title} - Abadicomm`}
    description={portfolio.description}
    openGraphImage={portfolio.title}
>
    <!-- Hero / Header -->
    <div class="relative h-[60vh] min-h-[500px]">
        <img
            src={portfolio.thumbnail}
            alt={portfolio.title}
            class="w-full h-full object-cover"
        />
        <div
            class="absolute inset-0 bg-black/60 bg-gradient-to-t from-black/80 to-transparent"
        >
        </div>
        <div class="absolute bottom-0 left-0 right-0 p-8 md:p-12">
            <div class="container mx-auto">
                <a
                    href="/portfolios"
                    class="inline-flex items-center text-white/80 hover:text-white mb-6 transition-colors"
                >
                    <ArrowLeft class="w-4 h-4 mr-2" /> Back to Portfolios
                </a>
                <h1 class="text-4xl md:text-6xl font-bold text-white mb-4">
                    {portfolio.title}
                </h1>
                <div class="flex flex-wrap gap-6 text-white/90">
                    <div class="flex items-center gap-2">
                        <Calendar class="w-5 h-5 text-primary" />
                        <span>{portfolio.year}</span>
                    </div>
                    <Tag class="w-5 h-5 text-primary" />
                    <span>{portfolio.categories.join(", ")}</span>
                </div>
                <div class="flex items-center gap-2">
                    <User class="w-5 h-5 text-primary" />
                    <span>{portfolio.hosters.join(", ")}</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Content -->
    <div class="container mx-auto px-4 py-16 md:py-24">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-12">
            <!-- Main Description -->
            <div class="lg:col-span-2 space-y-8">
                <!-- Gallery Grid -->
                <div>
                    <h3 class="text-xl font-bold mb-6">Event Gallery</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <!-- Thumbnail again as first image -->
                        <img
                            src={portfolio.thumbnail}
                            alt="Gallery 1"
                            class="rounded-xl w-full h-64 object-cover hover:scale-[1.02] transition-transform cursor-pointer"
                        />
                        {
                            portfolio.images.map((image, i) => (
                                <img
                                    src={image}
                                    alt={`Gallery ${i + 2}`}
                                    class="rounded-xl w-full h-64 object-cover hover:scale-[1.02] transition-transform cursor-pointer"
                                />
                            ))
                        }
                    </div>
                </div>

                <!-- Main Description -->
                <div
                    class="prose prose-lg dark:prose-invert max-w-none pt-8 border-t"
                >
                    <h2 class="text-2xl font-bold mb-4">About the Event</h2>
                    <p class="leading-relaxed text-muted-foreground">
                        {portfolio.description}
                    </p>
                    <p class="leading-relaxed text-muted-foreground">
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                        Sed do eiusmod tempor incididunt ut labore et dolore
                        magna aliqua. Ut enim ad minim veniam, quis nostrud
                        exercitation ullamco laboris nisi ut aliquip ex ea
                        commodo consequat.
                    </p>
                </div>
            </div>

            <!-- Sidebar CTA -->
            <div class="lg:col-span-1">
                <div
                    class="sticky top-24 bg-secondary/30 p-8 rounded-2xl border"
                >
                    <h3 class="text-xl font-bold mb-4">
                        Interested in similar event?
                    </h3>
                    <p class="text-muted-foreground mb-6">
                        Let us help you create spectacular events like this one.
                        Contact us for a free consultation.
                    </p>
                    <a
                        href="/#contact"
                        class="block w-full text-center py-3 bg-primary text-primary-foreground font-semibold rounded-lg hover:opacity-90 transition-opacity"
                    >
                        Wujudkan event anda dengan kami
                    </a>
                    <div class="mt-6 pt-6 border-t">
                        <h4 class="font-semibold mb-2 text-sm">
                            Event Details
                        </h4>
                        <ul class="space-y-2 text-sm text-muted-foreground">
                            <li class="flex justify-between">
                                <span>Client:</span>
                                <span class="text-foreground"
                                    >{portfolio.hosters.join(", ")}</span
                                >
                            </li>
                            <li class="flex justify-between">
                                <span>Year:</span>
                                <span class="text-foreground"
                                    >{portfolio.year}</span
                                >
                            </li>
                            <li class="flex justify-between">
                                <span>Category:</span>
                                <span class="text-foreground"
                                    >{portfolio.categories.join(", ")}</span
                                >
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</Layout>
