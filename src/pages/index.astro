---
import Layout from "../layouts/Layout.astro";
import FAQ from "../components/FAQ.svelte";
import { getCollection } from "astro:content";
import { getEntry } from "astro:content";
import { ArrowRight, Star, Network, Blocks } from "@lucide/svelte";
import ContactModal from "../components/ContactModal.svelte";

const allPortfolios = await getCollection("portfolios");
const featuredPortfolios = allPortfolios
	.map((entry) => ({ ...entry.data, slug: entry.data.title.replace(/\s+/g, '_') }))
	.sort((a, b) => Number(b.year) - Number(a.year))
	.slice(0, 3);

const galleryPage = await getEntry("site_content", "gallery");
const galleryData = galleryPage?.data;
---

<Layout
	openGraphImage="homepage"
>
	<!-- Hero Section -->
	<section
		class="relative h-[80vh] min-h-[600px] flex items-center justify-center overflow-hidden"
	>
		<div class="absolute inset-0 z-0">
			<img
				src="/uploads/event-atmosphere.webp"
				alt="Event Atmosphere"
				class="w-full h-full object-cover"
			/>
			<div
				class="absolute inset-0 bg-gradient-to-t from-background via-background/80 to-transparent"
			>
			</div>
		</div>

		<div class="container mx-auto px-4 relative z-10 text-center">
			<span
				class="inline-block animate-in fade-in slide-in-from-bottom-4 duration-700 px-4 py-1.5 mb-6 text-sm font-semibold tracking-wider text-black bg-primary/10 rounded-full border border-primary/20"
			>
				NO.1 EVENT ORGANIZER DI SURABAYA
			</span>
			<h1
				class="animate-in fade-in slide-in-from-bottom-8 duration-700 delay-100 text-5xl md:text-7xl font-bold tracking-tight mb-6 text-foreground max-w-4xl mx-auto leading-tight"
			>
				Wujudkan Event <span
					class="text-transparent bg-clip-text bg-gradient-to-r from-primary to-purple-400"
					>Spektakuler</span
				> yang Tak Terlupakan
			</h1>
			<p
				class="animate-in fade-in slide-in-from-bottom-8 duration-700 delay-200 text-lg md:text-xl text-muted-foreground max-w-2xl mx-auto mb-10 leading-relaxed"
			>
				Kami memadukan kreativitas dan profesionalisme untuk menciptakan
				pengalaman visual dan emosional terbaik bagi brand dan audiens
				Anda.
			</p>
			<div
				class="animate-in fade-in slide-in-from-bottom-8 duration-700 delay-300 flex flex-col sm:flex-row gap-4 justify-center"
			>
				<ContactModal client:idle>
					<button
						class="inline-flex items-center justify-center px-8 py-3.5 text-base font-semibold text-primary-foreground bg-primary rounded-full hover:bg-primary/90 transition-all shadow-lg shadow-primary/25 hover:shadow-primary/40 hover:-translate-y-0.5"
					>
						Konsultasi Gratis
					</button>
				</ContactModal>
				<a
					href="/portfolios"
					class="inline-flex items-center justify-center px-8 py-3.5 text-base font-semibold text-foreground bg-secondary/80 backdrop-blur-sm rounded-full hover:bg-secondary transition-all border border-border"
				>
					Lihat Portfolio
				</a>
			</div>
		</div>
	</section>

	<!-- Introduction/Trust Section -->
	<section class="py-20 md:py-28 bg-background">
		<div class="container mx-auto px-4">
			<div class="grid grid-cols-1 md:grid-cols-2 gap-16 items-center">
				<div class="relative">
					<div
						class="absolute -inset-4 bg-gradient-to-tr from-primary/20 to-purple-500/20 rounded-2xl blur-2xl opacity-70"
					>
					</div>
					<img
						src="/uploads/group-photo.webp"
						alt="Abadicomm Team"
						class="relative rounded-2xl shadow-xl border border-white/10 w-full"
					/>
				</div>
				<div>
					<h2 class="text-3xl md:text-4xl font-bold mb-6">
						Mengapa Memilih Abadicomm?
					</h2>
					<p
						class="text-muted-foreground mb-8 text-lg leading-relaxed"
					>
						Berdiri di jantung kota Surabaya, Abadicomm telah
						menjadi mitra terpercaya bagi ratusan perusahaan dan
						individu. Visi kami sederhana: <strong
							>Mengubah ide menjadi realitas yang memukau.</strong
						>
					</p>
					<div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
						<div class="flex gap-4">
							<div
								class="p-3 bg-primary/10 rounded-xl h-fit text-primary"
							>
								<Star class="w-6 h-6" />
							</div>
							<div>
								<h3 class="font-semibold mb-2">
									Ide Kreatif & Segar
								</h3>
								<p class="text-sm text-muted-foreground">
									Konsep unik yang disesuaikan dengan
									identitas brand Anda.
								</p>
							</div>
						</div>
						<div class="flex gap-4">
							<div
								class="p-3 bg-primary/10 rounded-xl h-fit text-primary"
							>
								<Network class="w-6 h-6" />
							</div>
							<div>
								<h3 class="font-semibold mb-2">
									Profesional & Terpercaya
								</h3>
								<p class="text-sm text-muted-foreground">
									Eksekusi tepat waktu dengan detail yang
									presisi.
								</p>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>

	<!-- Client Logos Section -->
	<section class="py-12 border-y bg-background overflow-hidden">
		<div class="container mx-auto px-4 mb-8 text-center">
			<h2
				class="text-xl font-semibold text-muted-foreground uppercase tracking-widest"
			>
				Dipercaya oleh Brand Ternama
			</h2>
		</div>

		<!-- Dual Behavior Scroller for Logos -->
		<div
			id="client-scroller"
			class="flex gap-12 overflow-x-auto no-scrollbar whitespace-nowrap px-4 cursor-grab active:cursor-grabbing opacity-60 hover:opacity-100 transition-opacity duration-300"
			style="-webkit-overflow-scrolling: touch;"
		>
			<!-- Set 1 -->
			<div
				class="flex gap-6 md:gap-12 shrink-0 items-center justify-around min-w-full"
			>
				{
					[1, 2, 3, 4, 5, 6, 7].map((i) => (
						<img
							src={`https://dummyjson.com/image/150x60/000/fff?text=Client+${i}`}
							alt={`Client ${i}`}
							class="h-8 md:h-10 w-auto object-contain opacity-50 grayscale hover:grayscale-0 hover:opacity-100 transition-all cursor-pointer"
						/>
					))
				}
			</div>
			<!-- Set 2 (Clone) -->
			<div
				class="flex gap-6 md:gap-12 shrink-0 items-center justify-around min-w-full"
			>
				{
					[1, 2, 3, 4, 5, 6, 7].map((i) => (
						<img
							src={`https://dummyjson.com/image/150x60/000/fff?text=Client+${i}`}
							alt={`Client ${i}`}
							class="h-8 md:h-10 w-auto object-contain opacity-50 grayscale hover:grayscale-0 hover:opacity-100 transition-all cursor-pointer"
						/>
					))
				}
			</div>
		</div>
	</section>

	<!-- Services Section -->
	<section class="py-20 bg-secondary/30" id="services">
		<div class="container mx-auto px-4 text-center">
			<h2 class="text-3xl md:text-4xl font-bold mb-4">
				Layanan Unggulan Kami
			</h2>
			<p class="text-muted-foreground max-w-2xl mx-auto mb-16">
				Solusi lengkap untuk segala kebutuhan event Anda, dari hulu ke
				hilir.
			</p>

			<div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-left">
				<!-- Service 1 -->
				<div
					class="group bg-background border p-8 rounded-2xl hover:border-primary/50 transition-colors shadow-sm hover:shadow-md"
				>
					<div
						class="w-14 h-14 bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 rounded-full flex items-center justify-center mb-6 group-hover:scale-110 transition-transform"
					>
						<Blocks class="w-7 h-7" />
					</div>
					<h3 class="text-xl font-bold mb-3">Concept Creation</h3>
					<p class="text-muted-foreground">
						Perancangan konsep acara yang kreatif, inovatif, dan
						relevan dengan target audiens Anda.
					</p>
				</div>

				<!-- Service 2 -->
				<div
					class="group bg-background border p-8 rounded-2xl hover:border-primary/50 transition-colors shadow-sm hover:shadow-md"
				>
					<div
						class="w-14 h-14 bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400 rounded-full flex items-center justify-center mb-6 group-hover:scale-110 transition-transform"
					>
						<Network class="w-7 h-7" />
					</div>
					<h3 class="text-xl font-bold mb-3">Event Production</h3>
					<p class="text-muted-foreground">
						Eksekusi teknis yang mulus mulai dari stage, sound,
						lighting, hingga multimedia.
					</p>
				</div>

				<!-- Service 3 -->
				<div
					class="group bg-background border p-8 rounded-2xl hover:border-primary/50 transition-colors shadow-sm hover:shadow-md"
				>
					<div
						class="w-14 h-14 bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400 rounded-full flex items-center justify-center mb-6 group-hover:scale-110 transition-transform"
					>
						<Star class="w-7 h-7" />
					</div>
					<h3 class="text-xl font-bold mb-3">Talent Management</h3>
					<p class="text-muted-foreground">
						Penyediaan MC, Musisi/Band, dan performa hiburan kelas
						atas.
					</p>
				</div>
			</div>
		</div>
	</section>

	<!-- Portfolio Preview -->
	<section class="py-20 md:py-28">
		<div class="container mx-auto px-4">
			<div
				class="flex flex-col md:flex-row justify-between items-start md:items-end mb-12 gap-4"
			>
				<div>
					<h2 class="text-3xl md:text-4xl font-bold mb-4">
						Karya Terbaik Kami
					</h2>
					<p class="text-muted-foreground max-w-xl">
						Intip beberapa event spektakuler yang telah kami
						sukseskan.
					</p>
				</div>
				<a
					href="/portfolios"
					class="flex items-center gap-2 font-semibold text-primary hover:text-primary/80 transition-colors group"
				>
					Lihat Semua Portfolio <ArrowRight
						class="w-4 h-4 group-hover:translate-x-1 transition-transform"
					/>
				</a>
			</div>

			<div class="grid grid-cols-1 md:grid-cols-3 gap-8">
				{
					featuredPortfolios.map((item) => (
						<a
							href={`/portfolios/${item.slug}`}
							class="group block"
						>
							<div class="relative overflow-hidden rounded-xl aspect-[3/2] mb-4">
								<img
									src={item.thumbnail}
									alt={item.title}
									class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
								/>
								<div class="absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center">
									<span class="text-white font-medium border border-white/50 px-4 py-2 rounded-full backdrop-blur-sm">
										Lihat Detail
									</span>
								</div>
							</div>
							<div class="space-y-2">
								<span class="text-xs font-semibold text-primary uppercase tracking-wider">
									{item.categories.join(", ")} &bull;{" "}
									{item.year}
								</span>
								<h3 class="text-xl font-bold group-hover:text-primary transition-colors">
									{item.title}
								</h3>
								<p class="text-muted-foreground text-sm line-clamp-2">
									{item.description}
								</p>
							</div>
						</a>
					))
				}
			</div>
		</div>
	</section>

	<!-- Activity Gallery -->
	<section class="py-20 bg-background overflow-hidden" id="gallery">
		<div class="container mx-auto px-4 mb-12 text-center">
			<h2 class="text-3xl font-bold mb-4">Activity Gallery</h2>
			<p class="text-muted-foreground">
				Dibalik layar dan keseruan tim kami di lapangan.
			</p>
		</div>

		<!-- Dual Behavior Scroller: Native Scroll + JS Auto Scroll -->
		 {galleryData && (
		 <div
			id="activity-scroller"
			class="flex gap-4 overflow-x-auto no-scrollbar whitespace-nowrap px-4 cursor-grab active:cursor-grabbing"
			style="-webkit-overflow-scrolling: touch;"
		>
			<!-- Set 1 -->
			<div class="flex gap-4 shrink-0" id="activity-set-1">
				{
					(galleryData.images??[]).slice(0, 6).map((imgSrc, index) => (
						<div class="w-[300px] h-[200px] flex-shrink-0 rounded-xl overflow-hidden relative group">
							<img
								src={imgSrc}
								class="w-full h-full object-cover"
								alt="Activity"
								loading="lazy"
							/>
							<div class="absolute inset-0 bg-black/20 group-hover:bg-transparent transition-colors" />
						</div>
					))
				}
			</div>
			<!-- Set 2 (Clone for Infinite Loop) -->
			<div class="flex gap-4 shrink-0" id="activity-set-2">
				{
					(galleryData.images??[]).slice(0, 6).map((imgSrc, index) => (
						<div class="w-[300px] h-[200px] flex-shrink-0 rounded-xl overflow-hidden relative group">
							<img
								src={imgSrc}
								class="w-full h-full object-cover"
								alt="Activity"
								loading="lazy"
							/>
							<div class="absolute inset-0 bg-black/20 group-hover:bg-transparent transition-colors" />
						</div>
					))
				}
			</div>
		</div>
		<div class="text-center mt-10">
			<div class="text-center mt-10">
				<a
					href="/gallery"
					class="text-sm font-semibold border px-6 py-2 rounded-full hover:bg-secondary transition-colors inline-block"
					>Load More Gallery</a
				>
			</div>
		</div>)
		}


		<!-- FAQ Section -->
		<section class="py-20 md:py-28 bg-secondary/30">
			<div class="container mx-auto px-4 text-center">
				<h2 class="text-3xl md:text-4xl font-bold mb-12">
					Frequently Asked Questions
				</h2>
				<FAQ client:visible />
			</div>
		</section>

		<!-- CTA Section -->
		<section
			class="py-24 bg-primary text-primary-foreground text-center"
			id="contact"
		>
			<div class="container mx-auto px-4">
				<h2
					class="text-3xl md:text-5xl font-bold mb-6 max-w-3xl mx-auto"
				>
					Siap Mewujudkan Event Impian Anda?
				</h2>
				<p
					class="text-primary-foreground/80 text-lg md:text-xl mb-10 max-w-2xl mx-auto"
				>
					Jangan ragu untuk berdiskusi dengan kami. Kami Siap Membantu.
				</p>
				<ContactModal client:idle>
					<button
						class="inline-flex items-center justify-center px-8 py-4 text-lg font-bold text-primary bg-background rounded-full hover:scale-105 transition-transform shadow-2xl"
					>
						Hubungi Kami Sekarang
					</button>
				</ContactModal>
			</div>
		</section>
	</section>

	<script is:inline>
		// JS Logic for Dual Behavior Scroller
		function setupDualScroller(id, speed = 0.5) {
			const scroller = document.getElementById(id);
			if (!scroller) return;

			let isPaused = false;

			function loop() {
				if (!isPaused) {
					// Check if we reached the mid-point (end of Set 1) to reset
					// We assume Set 1 and Set 2 are roughly equal width.
					// Using scrollWidth / 2 is a safe approximation if sets are identical.
					if (scroller.scrollLeft >= scroller.scrollWidth / 2) {
						scroller.scrollLeft = 0; // Seamless jump back to start
					} else {
						scroller.scrollLeft += speed;
					}
				}
				requestAnimationFrame(loop);
			}

			// Pause on interaction
			scroller.addEventListener("mouseenter", () => (isPaused = true));
			scroller.addEventListener("mouseleave", () => (isPaused = false));
			scroller.addEventListener("touchstart", () => (isPaused = true));
			scroller.addEventListener("touchend", () => {
				// Delay resume slightly to avoid conflict with momentum scroll ending
				setTimeout(() => (isPaused = false), 1000);
			});

			// Start animation
			loop();
		}

		// Initialize scrollers
		setupDualScroller("activity-scroller", 0.5);
		setupDualScroller("client-scroller", 0.3); // Slower for logos
	</script>

	<style>
		/* Custom request for no heavy animations, using simple tailwind utility or css */
		.animate-in {
			/* Using tailwind-animate-css if configured or fallback */
		}
		/* Hide scrollbar for Chrome, Safari and Opera */
		.no-scrollbar::-webkit-scrollbar {
			display: none;
		}
		/* Hide scrollbar for IE, Edge and Firefox */
		.no-scrollbar {
			-ms-overflow-style: none; /* IE and Edge */
			scrollbar-width: none; /* Firefox */
		}
		.text-transparent {
			-webkit-text-fill-color: transparent;
		}
	</style>
</Layout>
